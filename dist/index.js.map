{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport NProgress, { NProgressOptions } from 'nprogress';\n// import Router from 'next/router';\n\ninterface ProgressBarProps {\n  color?: string;\n  height?: string;\n  options?: Partial<NProgressOptions>;\n  appDirectory?: boolean;\n  shallowRouting?: boolean;\n}\n\ntype PushStateInput = [\n  data: any,\n  unused: string,\n  url?: string | URL | null | undefined,\n];\n\n/**\n * @param color Color of the progress bar.\n * @param height Height of the progress bar.\n * @param options NProgress options.\n * @param appDirectory If your are in the app directory - false by default\n * @param shallowRouting If the progress bar is not displayed when you use shallow routing - false by default\n */\n\nconst ProgressBar = React.memo(\n  ({\n    color = '#0A2FFF',\n    height = '2px',\n    options,\n    appDirectory = false,\n    shallowRouting = false,\n  }: ProgressBarProps) => {\n    const styles = (\n      <style>{`\n      #nprogress {\n        pointer-events: none;\n      }\n      #nprogress .bar {\n        background: ${color};\n        position: fixed;\n        z-index: 99999;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: ${height};\n      }\n      #nprogress .peg {\n        display: block;\n        position: absolute;\n        right: 0px;\n        width: 100px;\n        height: 100%;\n        box-shadow: 0 0 10px ${color}, 0 0 5px ${color};\n        opacity: 1;\n        transform: rotate(3deg) translate(0px, -4px);\n      }\n    `}</style>\n    );\n\n    useEffect(() => {\n      options && NProgress.configure(options);\n\n      if (appDirectory) {\n        NProgress.configure({ showSpinner: false });\n\n        const handleAnchorClick = (event: MouseEvent) => {\n          const targetUrl = (event.currentTarget as HTMLAnchorElement).href;\n          const currentUrl = location.href;\n          if (!shallowRouting || targetUrl !== currentUrl) {\n            NProgress.start();\n          }\n        };\n\n        const handleMutation: MutationCallback = () => {\n          const anchorElements = document.querySelectorAll('a');\n          anchorElements.forEach((anchor) =>\n            anchor.addEventListener('click', handleAnchorClick),\n          );\n        };\n\n        const mutationObserver = new MutationObserver(handleMutation);\n        mutationObserver.observe(document, { childList: true, subtree: true });\n\n        window.history.pushState = new Proxy(window.history.pushState, {\n          apply: (target, thisArg, argArray: PushStateInput) => {\n            NProgress.done();\n            return target.apply(thisArg, argArray);\n          },\n        });\n      } else {\n        import('next/router')\n          .then(({ default: Router }) => {\n            const handleRouteStart = (url: string) => {\n              if (!shallowRouting || url !== Router.route) {\n                NProgress.start();\n              }\n            };\n            const handleRouteDone = () => NProgress.done();\n\n            Router.events.on('routeChangeStart', handleRouteStart);\n            Router.events.on('routeChangeComplete', handleRouteDone);\n            Router.events.on('routeChangeError', handleRouteDone);\n\n            return () => {\n              // Make sure to remove the event handler on unmount!\n              Router.events.off('routeChangeStart', handleRouteStart);\n              Router.events.off('routeChangeComplete', handleRouteDone);\n              Router.events.off('routeChangeError', handleRouteDone);\n            };\n          })\n          .catch((err) => console.error('Failed to load module', err));\n      }\n    }, []);\n\n    return styles;\n  },\n  () => true,\n);\n\nexport default ProgressBar;\n"],"names":["useEffect"],"mappings":"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"}